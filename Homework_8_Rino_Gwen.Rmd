---
title: "COMPSCIX 415.2 Homework 8"
author: "Gwen Rino"
date: "3/21/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_packages, warning=FALSE, message=FALSE}
library(tidyverse)
library(broom)
library(rpart)
library(partykit)
library(ROCR)
```

***
## EXERCISE ONE  

This data set has 891 observations and 12 columns.  

```{r}
titanic <- read_csv("Titanic.csv")
nrow(titanic)
ncol(titanic)
```

***
## EXERCISE TWO  

```{r}
# Set seed
set.seed(29283)

# Convert Pclass to factor
titanic$Pclass <- factor(titanic$Pclass)

# Create training set
train_set <- titanic %>% sample_frac(0.7)

# Create test set (observations in titanic$PassengerId that are not in train_set$PassengerId)
test_set <- titanic %>% filter(!(titanic$PassengerId %in% train_set$PassengerId))
```

***
## EXERCISE THREE  

Preliminary to fitting the model...  
* My guess is that Pclass is associated with a negative probability of survival (1st class passengers more likely to survive than 3rd class passengers), Sex (female) is associated with a positive probability of survival ("Women and children first!"), and Fare is associated with a positive probability of survival.  
* My concern about this choice of features is that Fare and Pclass are probably correlated.  

```{r}
# Fit the logistic regression model
log_mod.1 <- glm(Survived ~ Pclass + Sex + Fare, data = titanic, family = "binomial")
# Output coefficients
tidy(log_mod.1)
```

The coefficients in the model show that:  
* The lower class the passenger is, the lower the probability of survival.  
* Being male is associated with a negative probability of survival.  
* Paying a higher fare is associated with a positive probability of survival.  

The p-values of the coefficients show that Pclass and Sex are statistically significant predictors of survival, but Fare is not.

***
## EXERCISE FOUR

```{r}
tree_mod.1 <- rpart(Survived ~ Pclass + Sex + Fare, data = titanic)
plot(as.party(tree_mod.1))
```


