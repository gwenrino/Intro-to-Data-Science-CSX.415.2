---
title: "COMPSCIX 415.2 Homework 7"
author: "Gwen Rino"
date: "March 13, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_packages, warning=FALSE, message=FALSE}
library(tidyverse)
library(broom)
```

***
## EXERCISE ONE  

This data set has 1460 observations and 81 columns.

```{r}
housing <- read_csv("train.csv")
glimpse(housing)
```

***
## EXERCISE TWO  

```{r}
# Set seed
set.seed(29283)

# Create training set
train_set <- housing %>% sample_frac(0.7)

# Create test set (observations in housing$Id that are not in train_set$Id)
test_set <- housing %>% filter(!(housing$Id %in% train_set$Id))
```

***
## EXERCISE THREE  

```{r}
# Fit a model with intercept only
mod_0 <- lm(SalePrice ~ 1, data = train_set)

# Double-check that the average SalePrice is equal to our model's coefficient
mean(train_set$SalePrice)
tidy(mod_0)

# Check the R-squared
glance(mod_0)
```

***
## EXERCISE FOUR  

```{r}
mod_1 <- lm(SalePrice ~ GrLivArea + OverallQual + Neighborhood, data = train_set)

tidy(mod_1)
glance(mod_1)
```

**QUESTIONS**  

**How would you interpret the coefficients on GrLivArea and OverallQual?**  
* GrLivArea: The sales price increases on average $62.78 for every additional square foot of above grade living area.  
* OverallQual: The sales price increases on average $21,692.23 for each unit increase in quality of material and finishes.  

**How would you interpret the coefficient on NeighborhoodBrkSide?**  
The mean sales price in the Brookside neighborhood is $14,064.37 less than the mean sales price in the baseline Bloomington Heights neighborhood.

**Are the features significant?**  
The features GrLivArea (p-value=1.34e-80) and OverallQual (p-value=1.39e-51) are statistically significant. However, BrkSide (p-value=0.21) is not significantly different from the baseline neighborhood Blmngtn.  

**Are the features practically significant?**  
* Given the cost of a house, a price difference of $62.78 is not important, so I would say that the GrLivArea feature is not practically significant.  
* However, a price difference of $21,692.23 for each level of OverallQual does seem practically significant to me.  
* Some of the levels of the Neighborhood feature are practically significant from the baseline (e.g. a home in StoneBr averages $65.7K more than a home in baseline Blmngtn), while other levels are not practically significant (e.g. a home in Mitchel averages only $1922.31 more than a home in baseline Blmngtn).


**Is the model a good fit (to the training set)?**  
With an adjusted R^2^ value of 0.8050277, the model is a good fit to the training set.

***
## EXERCISE FIVE  

This model, with a RMSE of ~$42K, is substantially better than using the mean sales price as a prediction (RMSE ~$79K).

```{r}
# Model predictions
test_predictions <- predict(mod_1, newdata = test_set)

# RMSE of model predictions
rmse_test <- sqrt(mean((test_set$SalePrice - test_predictions)^2))
rmse_test 

# For comparison, RMSE of mean price as prediction
rmse_mean <- sqrt(mean((test_set$SalePrice - mean(test_set$SalePrice))^2))
rmse_mean 
```

***
## EXERCISE SIX  

***
## EXERCISE SEVEN  

The model changes quite a lot (both the slope and the y-intercept) with each simulated data set.

```{r}
sim1a <- tibble(
  x = rep(1:10, each = 3),
  y = x * 1.5 + 6 + rt(length(x), df = 2)
)

mod_a <- lm(y ~ x, data = sim1a)

tidy(mod_a)

ggplot(sim1a, aes(x=x, y=y)) + geom_point() + geom_smooth(method=lm, se=FALSE)
```
